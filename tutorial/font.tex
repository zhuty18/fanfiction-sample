\ifdefined\freefont
    \usepackage{fontspec}
    \usepackage[fontset=none]{ctex}
    \setmainfont{EB Garamond 12 Regular}[Ligatures={Rare,Historic},Numbers=Lining,BoldFont=[EBGaramond08-Regular]]
    \setmonofont{Maple Mono Normal}

    \newfontfamily\ssfont{Vollkorn Medium Italic}
    \newfontfamily\chenfont{Vollkorn Italic}
    \newfontfamily\pagenfont{Vollkorn Italic}
    \newfontfamily\prenotefonten{EB Garamond 12 Regular}
    \newfontfamily\cpfont{Vollkorn}
    \newfontfamily\scfont{EB Garamond SmallCaps 12 Regular}

    \newfontfamily\mainreg{EB Garamond 12 Regular}[Numbers=Lining,Scale=1.2]
    \newfontfamily\mainsb{Vollkorn}[Numbers=Lining,Scale=1.15]
    \newfontfamily\mainb{Vollkorn Medium}[Scale=1.15,LetterSpace=-1]

    \newfontfamily\titlefonten{Allura}[LetterSpace=1]
    \newfontfamily\tempfont{Source Han Serif CN}

    \setCJKmainfont{Source Han Serif CN}[BoldFont=Source Han Serif CN SemiBold, ItalicFont=FZFangSong-Z02,BoldItalicFont=Source Han Serif CN Bold]
    \setCJKmonofont{FZHei-B01}

    \newCJKfontfamily\elsong{Source Han Serif CN ExtraLight}
    \newCJKfontfamily\lsong{Source Han Serif CN Light}
    \newCJKfontfamily\songti{Source Han Serif CN}
    \newCJKfontfamily\mediumsong{Source Han Serif CN Medium}
    \newCJKfontfamily\sbsong{Source Han Serif CN SemiBold}
    \newCJKfontfamily\bsong{Source Han Serif CN Bold}
    \newCJKfontfamily\hsong{Source Han Serif CN Heavy}

    \newCJKfontfamily\shusong{FZShuSong-Z01}[ItalicFont=FZKai-Z03] % 书宋
    \newCJKfontfamily\fangsong{FZFangSong-Z02} % 仿宋
    \newCJKfontfamily\heiti{FZHei-B01} % 黑体
    \newCJKfontfamily\kaiti{FZKai-Z03} % 楷体


    \newcommand{\titlefont}{\titlefonten\fangsong}
    \newcommand{\signfont}{\writing}

    \newcommand{\tocmain}{\bsong}
    \newcommand{\tocpart}{\sbsong\ssfont}
    \newcommand{\tocchapter}{\sbsong\chenfont}
    \newcommand{\tocchaplabel}{\itshape}
    \newcommand{\tocsection}{\songti}
    \newcommand{\tocsectlabel}{\scfont}
    \newcommand{\tocsubsection}{\tocsection}
    \newcommand{\tocsubsectlabel}{\tocsectlabel}
    \newcommand{\tocpage}{\pagenfont}

    \newcommand{\partfont}{\bsong\mainb}
    \newcommand{\chapterfont}{\bsong\mainb}
    \newcommand{\sectionfont}{\sbsong\mainsb}
    \newcommand{\subsectionfont}{\songti\mainreg}
    \newcommand{\pagenumberfont}{\tocpage}
    \newcommand{\headfont}{\kaiti\cpfont}
    \newcommand{\quotefont}{\itshape}
    \newcommand{\prenotefont}{\prenotefonten\sbsong}
    \newcommand{\writing}{\rmfamily\sbsong}
    \newcommand{\spellfont}{\quotefont}
    \newcommand{\dotfont}{\shusong}
\else
    \usepackage{ctex}
    \newcommand{\prenotefont}{\rmfamily}
    \newcommand{\titlefont}{}
    \newcommand{\signfont}{\ttfamily}
    \newcommand{\cpfont}{\ttfamily}

    \newcommand{\tocmain}{\bfseries}
    \newcommand{\tocpart}{\bfseries}
    \newcommand{\tocchapter}{\itshape}
    \newcommand{\tocchaplabel}{\itshape}
    \newcommand{\tocsection}{\rmfamily}
    \newcommand{\tocsectlabel}{\rmfamily}
    \newcommand{\tocsubsection}{\tocsection}
    \newcommand{\tocsubsectlabel}{\tocsectlabel}
    \newcommand{\tocpage}{\ttfamily}
    \newcommand{\ssfont}{\itshape}

    \newcommand{\partfont}{\bfseries\itshape}
    \newcommand{\chapterfont}{\bfseries}
    \newcommand{\sectionfont}{\bfseries}
    \newcommand{\subsectionfont}{\sffamily}
    \newcommand{\pagenumberfont}{\tocpage}
    \newcommand{\headfont}{\ttfamily}
    \newcommand{\quotefont}{\itshape}
    \newcommand{\writing}{\rmfamily\ttfamily}
    \newcommand{\spellfont}{\quotefont}
    \newcommand{\dotfont}{\rmfamily}
    \newcommand{\tempfont}{\rmfamily}
\fi
